<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <title>用户创建</title>
  <link href="/static/bootstrap-3.3.7-dist/css/bootstrap.css" rel="stylesheet">
  <link href="{{url_for('static',filename='users.css')}}" rel="stylesheet" type="text/css">
  <link href="{{ url_for('static', filename='bootstrapvalidator-0.4.5/dist/css/bootstrapValidator.min.css') }}" rel="stylesheet"/>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">CMDB</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a>欢迎{{session.get('user', {}).get('username', '')}}</a></li>
            <li><a href="/logout/">退出登录</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="/users/">用户管理</a></li>
            <li><a href="/logs/">访问日志分析</span></a></li>
          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="dialog">
            <form class="form-horizontal" id="create-user" action="/user/add/" method="post">
                {% if error %}
                <div class="form-group">
                    <label class="col-md-1 sr-only">错误说明:</label>
                    <div class="col-md-5">
                        <p class="form-control-static bg-danger">{{error}}</p>
                    </div>
                </div>
                {% endif %}
                <div class="form-group">
                    <label class="col-md-1 control-label">用户名:</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" name="username" value="{{username}}" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-1 control-label">密码:</label>
                    <div class="col-md-4">
                        <input class="form-control" type="password" name="password" value="{{password}}" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-1 control-label">年龄:</label>
                    <div class="col-md-4">
                        <input class="form-control" type="text" name="age" value="{{age}}" />
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-offset-1 col-md-4">
                    <button type="submit" class="btn btn-default" name="btn-submit">添加</button>
                    </div>
                </div>
            </form>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="{{url_for('static',filename='jquery-2.2.4.js')}}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='bootstrapvalidator-0.4.5/dist/js/bootstrapValidator.min.js') }}"></script>
    <script type="text/javascript">
     $(document).ready(function () {
       $('#create-user').bootstrapValidator({
            message: 'This value is not valid',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                username: {
                    message: 'The username is not valid',
                    validators: {
                        notEmpty: {
                            message: '用户名不能为空'
                        },
                        stringLength: {
                            min: 3,
                            max: 12,
                            message: '用户名必须大于3个字符, 并且小于12个字符'
                        }
                    }
                },
                password: {
                    validators: {
                        notEmpty: {
                            message: '密码不能为空'
                        },
                         stringLength: {
                            min: 6,
                            max: 12,
                            message: '密码必须大于6个字符, 并且小于12个字符'
                        }
                    }
                },
                age: {
                    validators: {
                        notEmpty: {
                            message: '年龄不能为空'
                        },
                         between: {
                            min: 19,
                            max: 65,
                            message: '年龄必须大于19个岁, 并且小于65个岁'
                        }
                    }
                }
            }
        });
         $('#btn-submit').on('click',function(){
        var _form = $('#dialog').find('form');
        console.log(_form)
        var bootstrapValidator = $(_form).data('bootstrapValidator');
        console.log(bootstrapValidator)
        bootstrapValidator.validate();
       });
     });
     </script>
  </body>
</html>
